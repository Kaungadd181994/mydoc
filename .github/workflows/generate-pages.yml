- name: Checkout repo
  uses: actions/checkout@v4
  with:
    fetch-depth: 0  # get full commit history so rebase works

- name: Configure Git
  run: |
    git config --global user.name "github-actions"
    git config --global user.email "github-actions@github.com"

- name: Commit and Push changes
  run: |
    git fetch origin main
    git checkout main
    git pull --rebase origin main || true  # rebase to avoid conflicts, ignore if nothing to pull
    git add pages.json
    git diff --quiet && git diff --staged --quiet || git commit -m "Auto-update pages.json"
    git push origin main
